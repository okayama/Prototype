<div class="row form-group">
  <div class="col-lg-2">
    <mt:var name="label" escape="1">
  </div>
  <div class="col-lg-10 form-inline">
    <mt:var name="edit" split=":" setvar="edit_props">
    <mt:var name="edit_props[1]" setvar="rel_model">
    <mt:var name="edit_props[2]" setvar="rel_col">
    <mt:var name="edit_props[3]" setvar="rel_type">
    <select id="questiontype_id-selector" class="form-control short watch-changed" name="<mt:var name="__col_name__">">
    <mt:objectloop model="$rel_model" sort_by="order">
    <mt:if name="__first__">
      <option value="">
        <mt:trans phrase="Unspecified">
      </option>
    </mt:if>
      <option class="<mt:var name="basename"escape>" <mt:if name="__col_value__" eq="$id">selected</mt:if> value="<mt:var name="id">"><mt:var name="$rel_col" trans="$translate" escape></option>
    </mt:objectloop>
    </select>
    <button class="btn btn-secondary" type="button" id="_apply_question_type"><mt:trans phrase="Apply"></button>
    &nbsp; &nbsp; &nbsp; 
    <input type="hidden" name="required" value="0">
    <label class="custom-control custom-checkbox">
    <input id="normarize" class="form-control custom-control-input watch-changed"
    <mt:if name="readonly">onclick="return false;"</mt:if>
     type="checkbox" name="required" value="1" <mt:if name="object_required">checked</mt:if>>
        <span class="custom-control-indicator"></span>
        <span class="custom-control-description"> 
        <mt:trans phrase="Required"></span>
    </label>
  </div>
</div>
<script>
$('#questiontype_id-selector').change(function(){
    var class_name = $('[name=<mt:var name="__col_name__">] option:selected').prop('class');
    if ( class_name.indexOf('text') != -1 ) {
        $('#placeholder-wrapper').show();
    } else {
        $('#placeholder-wrapper').hide();
    }
    if ( class_name.indexOf('checkboxes') != -1
        || class_name.indexOf('radio') != -1
        || class_name.indexOf('dropdown') != -1
        || class_name.indexOf('input_group') != -1 ) {
        $('#options-wrapper').show();
        $('#values-wrapper').show();
        if ( class_name.indexOf('checkboxes') != -1 ) {
            if (! $('#connector').val() ) {
                $('#connector').val(', ');
            }
        }
    } else {
        $('#options-wrapper').hide();
        $('#values-wrapper').hide();
    }
    if ( class_name.indexOf('textarea') != -1 ) {
        $('#rows-wrapper').show();
    } else {
        $('#rows-wrapper').hide();
    }
    if ( class_name.indexOf('checkboxes') != -1
        || class_name.indexOf('date') != -1
        || class_name.indexOf('input_group') != -1 ) {
        $('#connector-wrapper').show();
    } else {
        $('#connector-wrapper').hide();
    }
    if ( class_name.indexOf('input_group') != -1 ) {
        $('#count_fields-wrapper').show();
        $('#values-wrapper').hide();
        $('#options-hint').html('<mt:trans phrase="Please enter the width (number) of the fields(Comma separated list).">');
    } else {
        $('#count_fields-wrapper').hide();
        $('#options-hint').html('<mt:trans phrase="Please enter all allowable options for this field as a comma separated list.">');
    }
    if ( class_name.indexOf('date') != -1 ) {
        if (! $('#connector').val() ) {
            $('#connector').val('<mt:trans phrase="(Year)">,<mt:trans phrase="(Month)">,<mt:trans phrase="(Day)">');
        }
        if (! $('#default_value').val() ) {
            $('#default_value').val('<'+'mt:date format="Y"'+'>,<'+'mt:date format="m"'+'>,<'+'mt:date format="d"'+'>');
        }
        $('#options-wrapper').show();
        if (! $('#options').val() ) {
            $('#options').val('1930,<'+'mt:date format="Y"'+'>');
        }
    }
});
$('#_apply_question_type').click(function(){
    var questiontype_id = $('#questiontype_id-selector').val();
    if ( questiontype_id ) {
        if ( !confirm('<mt:trans phrase="Are you sure you want to apply the default template?">') ) {
            return false;
        }
        var str = '__mode=get_field_html&_type=questiontype';
        str += '&magic_token=<mt:var name="magic_token">&id=' + questiontype_id;
        $.post('<mt:var name="script_uri">', str,
            function ( data ) {
                if ( data.status != 200 ) {
                    alert( data.message );
                    return;
                }
                $('#template').val( data.content );
                disp_header_alert( '<mt:trans phrase="The default template was successfully applied. The applied template will not be reflected until you save this page.">' );
            },
            'json'
        );
    } else {
        alert('<mt:trans phrase="Model not specified.">');
    }
});
</script>