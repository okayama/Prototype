## 2018\-12\-19

version 1\.002

- グローバル・モディファイア encode\_php を追加しました。
- グローバル・モディファイア encode\_xml、メソッド escape\('xml'\)が正しく動作していなかった問題を修正しました。
- グローバル・モディファイア escape の属性値に「js」「xml」「php」が新しく指定可能になりました。
- 画像サムネイルの有無ついて、オブジェクトの Diffの対象外となるようにしました。
- Websiteテーマの \.htaccess で、ErrorDocumentのパスが正しくない問題を修正しました。
- URLInfoオブジェクトが論理削除された時、同一URLのオブジェクトが存在する時は物理削除するようにしました。
- URLMappingモデルの編集画面におけるラベルをPowerCMS互換に変更、ラベル「モデル」を「アーカイブ種別」に、モデルの選択肢「ビュー」を「インデックス」に変更しました。
- ワークフロー設定時にオブジェクトの新規作成時、ステータス変更時に不要なアラートが表示される問題を修正しました。
- アイテム挿入時にチェックボックスがキーボード操作できない問題を修正しました。
- ブロックタグ「mtsethashvars」ファンクションタグ「mtgethashvar」タグを追加しました。
- 環境変数「temp\_dir」の初期値を「/tmp」に変更しました。
- 記事/ページの編集画面で、エラーの際に本文が引き継がれない問題を修正しました。
- 標準関数 eachが非推奨になったことによる Text/Diffのエラーを修正しました。
- テーマの CSSを修正しました。

## 2018\-12\-06

version 1\.0013

- \(公開側ページの\)一覧画面に limit/offset パラメタを指定したとき、ページネーションが有効になるようになりました。
- 外部プレビューのための設定がオブジクトの編集画面に表示されない問題を修正しました。
- 時限公開・差し替え処理の実行時に、再構築トリガーが処理されない問題を修正しました。
- workspace\_id が nullのレコードの値を「0」にセットするアップグレード処理を追加しました。
- 問い合わせフォーム以外の URLマッピングのファイル出力を「ダイナミック」から「静的」に変更しました。
- pageモデルのスキーマバージョンをバージョンアップしました。
- スタティックなページへのリクエストにパラメタがついている時、または GET以外のリクエストの時、動的処理が通るように修正しました。
- テーマの一覧画面にサムネイルを追加しました。

## 2018\-12\-05

version 1\.0012

- フォーム機能でメール From, Cc, Bccを指定できるようになりました。
- 存在しないカラムを sortのキーに指定した時にエラーになる問題を修正しました。
- プレビューで urlmappingが読み込めていない時、エラーを吐いて HTMLがそのまま表示される問題を修正しました。
- 標準関数 eachが非推奨になったことによる Text/Diffのエラーを修正しました。
- テーマの \.htaccess が、ビューから出力された pt\-view\.phpを参照するように修正されました。
- ライブプレビュー時に、リビジョンのファイルの URLが出力されない問題を修正しました。
- テーマに metaタグ\(description, keywords\)を追加しました。
- テンプレートのビルド時にコンパイル済みキャッシュが使われていないケースがある問題を修正しました。
- 特定条件下における Objectをループ出力するブロック・タグの処理速度を向上しました。
- オブジェクトのカウントタグが正しい数字を返さないケースに対する修正を行いました。

## 2018\-12\-03

version 1\.001

- 新規インストール時に\(タイムアウト対策のため\)進捗を表示するようになりました。
- 再構築の最初のリクエスト時にインジケーターを表示するようにしました。
- オブジェクトのカウントタグがコンテキストによって取得できない問題を修正しました。
- テーマにウィジェットの2カラム表示モジュールを追加しました。
- ウィジェット内の a要素に対する CSSを追加しました。
- テーマに \.htaccessと pt-view\.phpを追加しました。
- ファンクションタグ「mtphpstart」「mtphpend」を追加しました。
- フォームの設問で値の連結設定をしている時に、値が空欄の時バリデーション処理でエラーになる問題を修正しました。
- ビューの編集画面で、画面幅を狭くした時にパーマリンク横の「ビュー」リンクが消える問題を修正しました。
- URLマッピングに「優先」カラムを追加しました。同一モデルに複数のマッピングが存在する時、優先指定のあるマッピングがパーマリンクに使われます。
- 特定の条件下で、ダイナミックパブリッシングで正常にページが返されるのにステータスが404になる点を修正しました。
- フォーム投稿時のメール送信処理で、テンプレートモジュールが正常にロードできない問題を修正しました。
- オブジェクトの保存時や再構築時に、pre\_listingコールバックの処理をスキップするようにしました。
- 再構築処理時に未公開のオブジェクトをスキップするようにしました。
- 上記の関係で、オブジェクトのインポート時に、非公開オブジェクトの再構築処理が走るようになりました。
- 404テンプレートで、workspaceコンテキストが正しくセットされない点を修正しました。
- テーマの 404テンプレートを1カラムレイアウトに変更しました。
- 新規オブジェクト作成時に、meta, relationのロード処理が走っていた問題を修正しました。
- テンプレートのキャッシュ機能を有効にしている時、トークンが必要なフォームの投稿がエラーになる問題を修正しました。

## 2018\-11\-25

version 1\.00

- テーマのエクスポート機能、インポート機能を追加しました。
- デフォルトのテーマ「Website」を追加しました。
- サイトマップのツリー表示で、サブフォルダよりもフォルダ直下のオブジェクトを上部に表示できるようにしました。
- スキーマ画面管理・プラグイン管理画面がキーボード操作できない問題を修正しました。
- オブジェクトの編集画面から、オブジェクトが削除できない問題を修正しました。
- メニューオブジェクトのループ出力後に、該当するオブジェクトのプライマリカラム、IDカラム以外のカラム値が空のままキャッシュされてしまう問題を修正しました。
- 別のオブジェクトのコンテキストをセットしたとき、アーカイブオブジェクトのパーマリンクが取得できない問題を修正しました。
- モデルの設定画面でフォームを追加できるようになりました。
- 「ビュー」にフォームを追加しました。
- ファンクションタグ「mtwebsitename」「mtwebsiteurl」「mtwebsitelanguage」「mtwebsiteid」「mtwebsitecopyright」「mtwebsitedescription」を追加しました。
- ファンクションタグ「mthex2rgba」を追加しました。hex指定された色指定を rgba形式に変換します。
- グローバルモディファイア「language\(「ja」などの言語を指定して翻訳\)」「\_eval\(evalとの違いは、\{\{mt:タグ名\}\}形式の記述が利用できる点\)」を追加しました。
- workspace\_id カラムの値が nullの時、システムスコープのビューでオブジェクトの一覧が取得できない問題を修正しました。
- 階層付きオブジェクトが workspace\_id カラムを持つとき、システムスコープではシステムスコープのオブジェクトのみが一覧表示されるようになりました。
- 再構築トリガーがオブジェクトの削除処理の際に処理されない問題を修正しました。
- システム設定に、システムの説明\(description\)を登録できるようになりました。
- スペース設定に、コピーライト\(copyright\)を登録できるようになりました。
- システム設定に、すべてのユーザーのログインにIPアドレス制限が設定できるようになりました。
- システム設定に「許可されたIPアドレスをロックしない」設定が追加されました。
- 設問タイプのマークアップが、tableマークアップに変更され、テーマ「Website」に合わせたクラス名が付与されるようになりました。
- ブロックタグ「mtif」に「tag」モディファイアを指定したとき、eq、likeなどの比較演算子が使えるようになりました。
- フォームの管理者への通知メールが、投稿者のメールアドレスに送信されてしまう問題を修正しました。
- ダイナミックパブリッシングにおいて、不要な SQLクエリが発行されていた問題を修正しました。
- workspace\_idなど、いくつかの数値型のカラムの初期値を NULLから0に修正しました。
- オブジェクトのループ出力、階層表示、リレーション型のカラムを出力するブロックタグで「cols」モディファイア\(SELECT対象のカラム名のカンマ区切り\)が指定できるようになりました。
- id, status, workspace\_idカラムのあるオブジェクトでは「cols」モディファイアに、これらのカラムが自動的に追加されます。
- 「ページ」に対する「フォルダ」、「記事」に対する「カテゴリ」の CSVインポート/エクスポートにおける処理を改良しました。
- 新規インストール時に sessionレコードを取得しに行ってログに warnings が記録される問題を修正しました。
- LivePreview 時に オブジェクトのループ出力のブロック・タグの include\_draft モディファイアが効かない問題を修正しました。
- mtsetcontextブロックタグ内で、元のオブジェクトのカラム値を取得するファンクションタグの値が空になる問題を修正しました。
- テンプレート変数「current\_archive\_model」と「current\_object\_id」をセットするようになりました。
- フォームに「model」「object\_id」パエメタを渡すことで、コンタクトの対象オブジェクトをセットできるようになりました。
- フォームに「identifier」パラメタを渡せるようになりました。
- publish\_obj メソッドで、dependencies\(依存オブジェクトの再構築\)をデフォルトでオフにしました。
- フォームのトークンの有効期限が切れた時、もしくはトークンが無効の時、エラー画面にならない問題を修正しました。
- 「ビュー」の編集画面の表示レスポンスを改善しました。
- 「mtinclude」を含む「ビュー」の編集画面の表示の際に httpd の負荷が上がり、表示に時間がかかる問題を修正しました。
- ドキュメント\(ユーザーガイド\)を更新しました。

## 2018\-11\-12

version 0\.99

- URLマップの作成・編集画面で URLマップが静的生成もしくはオンデマンドの時、再構築トリガーを設定できるようになりました。
- システムスコープの URLマップで「コンテナ」のスコープにスペースのオブジェクトを含まない設定ができるようになりました。
- 「entry」「category」モデルのオブジェクトがシステムスコープに作成できるようになりました。
- 「page」「folder」「widget」モデルを新しく追加しました。
- オブジェクトの作成・編集画面で、数値+階層型のカラムのレイアウトを調整しました。
- システムとワークスペースに作成できるオブジェクトの一覧画面について、「表示順」「階層」指定のあるモデルについては、同一スコープのオブジェクトのみの一覧を表示するようになりました。
- オブジェクトの作成・編集画面で「リレーション」「階層」を指定している時、同一スコープのオブジェクトのみを階層表示するようになりました。
- モデルの編集画面でカラムの「詳細」ダイアログで、\(システムが生成するカラム以外の\)文字列型、数値型、真偽値型のカラムの初期値を設定できるようになりました。
- モデルの設定で「アセット(アセットモデルのリレーション型のカラム)」を作成できるようになりました。通常の関連付けのほか、エディタへの貼り付けで関連アセットが追加されます。
- モデル「記事」にリレーション\(1対多\)型のカラム「アセット」を追加しました。
- URLマップで1対1のリレーションを設定しているモデルを「コンテナ」に指定できるようになりました。
- PHP設定の max\_input\_varsの推奨値より小さな値が設定されている時、モデルの編集画面に警告を表示するようになりました。
- 一覧画面のチェックボックスのアクセシビリティを改善しました\(キーボード操作対応とラベルの付与\)。
- URLの一覧画面ですべてを選択するチェックボックスのラベルで件数が正しくない数字になることがある点を修正しました。
- 「Directory」の翻訳フレーズを「フォルダ」から「ディレクトリ」に変更しました。
- モデル'queue'は今後標準モデルとして追加の可能性があるため、予約名としました。
- 「entry」「page」「widget」モデルで、テキストフォーマットの初期値を選択できるようになりました。
- ツリー表示でディレクトリにアイテムがない時、ログにエラーが残る問題を修正しました。
- リレーション\(1対多\)型のカラムを削除した時、該当する mt\_relationレコードを削除するようになりました。
- システムスコープの URLの一覧からワークスペース配下の URLの物理削除ができない問題を修正しました。
- 論理削除済みの URLに該当するアーカイブの再構築で、同一 URLの URLオブジェクトが生成されてしまう問題を修正しました。
- 「自分のオブジェクト」のみに権限が割り当てられている時、ファイル型のカラムに対する アップロードが 権限エラーになる問題を修正しました。
- ハンバーガーメニューのコントラストを改善しました。
- 階層指定のあるモデルの新規作成画面で、親を選択するとエラーで保存できない問題を修正しました。
- ファンクションタグ「mtassetproperty」が正しい値を返さない問題を修正しました。
- フォームの「Text Input Group」でコネクタの出力をした際に、以降の設問でもコネクタが出力されてしまう問題を修正しました。
- PTUtil::object\_diff メソッドが一部のカラムをスキップしてしまう問題を修正しました。
- 管理者ログイン用のIPアドレスが登録できない問題を修正しました。
- Smarty互換テンプレート記法はサポート対象外となりました。
- ドキュメント\(ユーザーガイド\)を更新しました。

## 2018\-11\-07

version 0\.98

- インストール時にエラーログが記録される点を修正しました。
- スマートフォンで管理画面を利用した時のレイアウトを調整しました。
- オブジェクトの値に絵文字を含められるようになりました。保存できない、または表示できない時は、環境変数「set\_names」に trueを指定してください。
- ブロックタグ「mtnestableobjects」および、リレーションを出力するブロックタグが LivePreviewに対応しました。
- 「メニュー」モデルを追加し、ブロックタグ「mtmenuitems」タグを追加しました。タグは LivePreviewに対応しています。
- これにより、階層付き、任意の並び順のメニューを作成できるようになりました。
- モデルをエクスポートする時、hide\_edit\_options指定のないモデルで warningが発生していた点を修正しました。
- 階層を持つオブジェクトの親に子オブジェクトを指定した時、あるいはルートオブジェクトが存在しなくなってしまう時、エラーを出すようにしました。
- また、階層を持つオブジェクトの編集画面で、子オブジェクトを親に指定できなくなりました。
- 環境変数「password\_letternum\(パスワードに英数字両方を含む\)」を追加しました。
- 環境変数「password\_upperlower\(パスワードに英字大文字小文字両方を含む\)」を追加しました。
- 環境変数「password\_symbol\(パスワードに記号を含む\)」を追加しました。
- 環境変数「password\_min\(パスワードの必要文字数\)」を追加しました。
- TinyMCEプラグインで、メニューバーがカスタマイズできるようになりました。
- ドキュメント\(ユーザーガイド\)を更新しました。

## 2018\-11\-06

# version 0\.97

- 新規インストール時に mt\_sessionテーブルが生成されない問題を修正しました。
- ビューのソースが空の時に、タグパーサがエラーを出していた問題を修正しました。
- 1対1のリレーションの時、タッチデバイスでサムネイルが拡大表示できない問題を修正しました。
- 新規インストール時の「ビュー」のメニュータイプをお気に入り\(Favorites\)に変更しました。

## 2018\-11\-05

# version 0\.96

- リッチテキストエディタ\(TinyMCE\)のバージョンを4\.8\.5にバージョンアップしました。
- TinyMCEプラグイン設定で、モバイルモードの使用を選択できるようになりました。
- サイトマップのツリーでサブフォルダが存在する時にURLが取得できていなかった点を修正しました。
- ダイナミック・パブリッシングで、URLマッピングのコンテナが正しくセットされなかった点を修正しました。
- ブロックタグ「mtarchivelist」が日別アーカイブをサポートしました。
- ブロックタグ「mtsetcontext」タグを追加しました。
- オブジェクトの作成・編集画面でリレーション型のカラム・階層のときの表示レイアウトを調整しました。
- サイトマップのツリーで、権限のない未公開のURLをツリーから除外するようになりました。
- フォーム機能で CSRF対策用の セッションがフォーム投稿後も残る問題を修正しました。
- ビューの compiledカラムをリビジョンの差分対象外としました。
- ダッシュボードウィジェットのドラッグできる領域をウィジェットのヘッダ部分に限定しました。
- ドキュメント\(ユーザーガイド\)を更新しました。

## 2018\-10\-31

# version 0\.95

- モデル「ビュー」のプレビューで warningが発生していた点を修正しました。
- モデル「ビュー」の編集画面で「保存と再構築」ボタンをクリックして保存した時、再構築されない問題を修正しました。
- フォームの確認画面が表示できない点を修正しました。
- ブロックタグ「mtcalendar」を追加しました。
- 日別アーカイブをサポートしました。
- 日付ベースアーカイブの時、URLオブジェクトの archive\_typeが空になっていた点を修正しました。
- リッチテキストへの画像挿入時に、オリジナルの幅と高さを表示するようにしました。
- 作成・編集画面でリレーション\(複数選択ダイアログの時\)の選択済み要素をドラッグして順番を入れ替えた時、バッヂのマージンがなくなる問題を修正しました。
- ドラッグ&ドロップで順番を入れ替え可能な要素\(一覧画面の表示順入れ替えを除く\)がキーボード操作でも順序を入れ替えられるようになりました。
- 一部のフォームコントロールでフォーカスインジケーターが非表示になる問題を修正しました。

## 2018\-10\-30

# version 0\.94

- URLオブジェクトのアクション「URLのリセット」を追加しました。
- URLオブジェクトのアクション「物理削除」でオブジェクトが物理削除されない問題を修正しました。
- 一覧画面からのアクション実行時に、アクションが適用されているのに「対象の\(モデル名\)がありません。」と表示されることがある問題を修正しました。
- アセットの一覧画面からファイルをアップロードした時、warningが発生し、アップロードファイルサイズのチェックが正しく働いていなかった点を修正しました。
- アセットの一覧画面から日本語などマルチバイトのファイル名のファイルをアップロードした時、ラベルが URLエンコードされてしまう問題を修正しました。
- 権限チェックのコードで「すべてのオブジェクト\(update\_all\)」が割り当てられているのに falseを返すことがある問題を修正しました。
- リレーション型のカラムにアセット\(asset\)モデルを指定している時、権限のあるユーザーはアセットのラベルを編集できるようになりました。
- ダイナミック・パブリッシングの時、「URL」「対象のモデル」「ビュー」のうち最も新しいオブジェクトの更新タイムスタンプをブラウザキャッシュの利用基準としました。
- ExternalPreviewプラグインのプラグイン設定の編集画面のUIを改良しました。
- UUIDカラムがない時またはURLが発行されていない時に ExternalPreviewプラグインによる\(編集画面のボタンや日付欄など\)UIを非表示にしました。
- リレーションカラム名に\_などの英数文字以外の記号を含む時、テンプレート・タグが正しく認識されない問題を修正しました。
- データに更新がない時も、URLオブジェクトの最終更新日時が更新されてしまう問題を修正しました。
- ExternalPreviewプラグインによるプレビューに対応させるため、entryモデルと assetモデルにUUIDカラムを追加\(復活\)しました。
- 環境変数 build\_one\_by\_oneがセットされている時、正しい内容・正しいパスにファイルがパブリッシュされない問題を修正しました。

# version 0\.93

## 2018\-10\-29

- db\-config\.php\-original\.txt を db\-config\.php\-original\.php にリネームしました。
- CMSと公開サイトのドメインが異なるとき、公開サイトにログインできる機能を追加しました。
- 非公開のオブジェクトが非ログインユーザーに見えてしまうケースがある問題を修正しました。
- 上記の機能追加により、CMSと公開サイトのドメインが異なるときにログインユーザーが非公開URLを確認できるようになりました。
- 同様にCMSと公開サイトのドメインが異なるときに LivePreviewによる未来日のウェブサイトの確認ができるようになりました。
- オブジェクト名\+Next、Previousブロックタグにタグ属性 rebuild="1" 指定で\(オブジェクトの保存時の再構築に限り\)前後のオブジェクトを再構築するようになりました。
- 記事・アセットの公開日・非公開日が正しく保存されない問題を修正しました。
- アップグレード処理のタイムアウト時間を延ばしました。
- URLの一覧画面で、検索結果が正しい結果を返さない問題を修正しました。
- インポート機能で、アップロードファイルがインポート前に削除されてしまう問題を修正しました。
- プラグイン「EntryImporter」でインポートの進捗が画面に出力されない問題を修正しました。

# version 0\.92

## 2018\-10\-25

- 【重要】db\-config\.phpの定数名が変更になりました。各定数の先頭に「PADO\_」を追加してください。
- db\-config\.php を db\-config\.php\-original\.txt にリネームしました。
- データベースのスキーマアップグレードをダッシュボードとバッジで知らせるようになりました。
- アクティビティ・ダッシュボードウィジェットが特定のウィンドウサイズでちらつく問題を解消しました。
- MySQLの設定で ONLY\_FULL\_GROUP\_BYが指定されている時、アクティビティ・ダッシュボードがエラーになる点を修正しました。
- アクティビティ・ダッシュボードのグラフが公開日・作成日ベースから更新日ベースに変更されました。
- 最初のインストール時にログを記録するようになりました。
- Internet Explorer 11でオブジェクトの保存が重複する問題を修正しました。
- Internet Explorer 11 / Microsoft Edgeで一部の画面が崩れる問題を修正しました。
- 一部のモーダル画面が iOS・Safariでスクロールできない問題を修正しました。
- ビューの編集画面のテンプレート・タグの構文チェックで閉じタグがあるのに見つからないエラーとなる点を修正しました。
- ビューの編集画面のテンプレート・タグの構文チェックのエラーメッセージを翻訳しました。
- 一覧画面での「階層の管理」ボタンを画面幅が狭い時にアイコン表示になるようにしました。
- ステータスを公開に変更して保存した時に不要なリビジョン・添付ファイルが生成される問題を解消しました。
- お知らせをダッシュボードに追加し、バージョンアップ情報などをダッシュボードで確認できるようになりました。
- 「イベントとニュース」ダッシュボードを追加しました。
- インポートや worker\.phpなど、多くの処理を実行する際にメモリ不足となる可能性がある点を解消しました。
- また、これらの多くの処理を実行する際に PHPのタイムアウトを延長できるようにしました\(デフォルト3600秒\)。
- ウィジェットのデフォルト表示順をプラグインなどで指定できるようになりました。
- テンプレート変数 app\_version で、バージョン情報を取得できるようにしました。
- インストール時のアプリ名、コピーライトの初期値を設定済みにしました。
- 環境変数 image\_qualityで、サムネイルなどを作成する際の画像圧縮率を数値指定\(デフォルト60\)できるようになりました\(0\(最低品質\)〜100\(最高品質\)\)。
- 環境変数 error\_document404で、エラーページのパスを指定できるようになりました。
- アイテムの新規作成画面でラベル欄が空の時、アップロード時にファイル名をラベル欄にセットするようにしました。
- モデル「記事」のデフォルトカラム「og\_image」は削除されました。後から追加することはできます。
- デバッグモードが有効の時、モーダルダイアログや管理画面のページ下部が隠れてしまう点を修正しました。

# version 0\.91

## 2018\-10\-23

- 【重要】db\-config\.json\.cgiは セキュリティの観点から db\-config\.phpに変更されました。後方互換性は維持されています。
- ビューの編集画面でテンプレート・タグの構文チェックを行えるようになりました。
- ビューの編集画面で CodeMirrorのシンタックスハイライトにテンプレート・タグが対応していない点を修正しました。
- アクティビティ・ダッシュボードウィジェットで任意のモデルを選択できるようになりました。
- MySQLデータベースのテーブル圧縮に対応しました。
- 直列型ワークフローが設定されている時のUIを改善しました。
- テンプレート\(ビュー\)のインライン変数はサポート外になりました。
- ワークスペースのツールバーをユーザー設定で画面上部に固定できるようになりました。
- 画面幅を狭めた時もワークスペースのセレクタが常時表示されるようになりました。
- CSVからのインポート速度が高速化されました。
- モデルへの添付ファイル機能が追加されました。
- ファイルアップロードオプション\(画像サイズ、最大容量\)の設定が可能になりました。
- カスタム・設問タイプのクラス指定が可能になりました。
- モデルのメニュータイプ「お気に入り\(Favorites\)」が追加されました。
- URLオブジェクト\(urlinfoモデル\)を論理削除するように変更しました。
- デフォルトのモデルからUUIDカラムを削除しました。後から追加は可能です。
- デバッグモードが有効の時、デバッグ表示エリアの大きさをマウスドラッグで変更できるようになりました。
- ドキュメント\(ユーザーガイド\)を更新しました。
