<mt:if name="config_saved">
<script>
window.parent.disp_header_alert("<mt:trans phrase="Plugin %s's settings has been saved." params="$plugin_label">");
window.parent.$('#modal').modal('hide');
window.location.href = '<mt:var name="script_uri">?__mode=loading';
</script>
<mt:else>
<mt:setvar name="full_title" value="1">
<mt:include file="include/dialog_header.tmpl">
<form action="<mt:var name="script_uri">" method="POST">
<input type="hidden" name="__mode" value="manage_plugins">
<input type="hidden" name="magic_token" value="<mt:var name="magic_token">">
<input type="hidden" name="workspace_id" value="<mt:var name="workspace_id">">
<input type="hidden" name="plugin_id" value="<mt:var name="request.plugin_id" escape>">
<input type="hidden" name="save_config" value="1">
<input type="hidden" name="edit_settings" value="1">

<mt:var name="cfg_tmpl">

<div class="plugin-action-buttons">
  <button id="dialog-cancel-btn" class="btn btn-secondary" type="submit"><mt:trans phrase="Cancel"></button>
  <button id="dialog-save-btn" class="btn btn-primary" type="submit"><mt:trans phrase="Save"></button>
</div>
</form>
<script>
$('#dialog-cancel-btn').click(function(){
    window.parent.$('#modal').modal('hide');
    window.location.href = '<mt:var name="script_uri">?__mode=loading';
    return false;
});
$(document).keydown(evnt_keydown);
function evnt_keydown(e) {
    if ( e.keyCode == 27 ) {
        window.parent.$('#modal').modal('hide');
        window.location.href = '<mt:var name="script_uri">?__mode=loading';
    }
}
</script>

<mt:include file="include/dialog_footer.tmpl">
</mt:if>